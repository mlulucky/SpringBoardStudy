<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layout}"
>
<!-- layout:decorate="~{/layout} layout ì— í¬í•¨ì‹œí‚¤ê² ë‹¤.-->
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œê¸€ ìˆ˜ì •</title>
    <style>
        /* ì´ë¯¸ì§€ í´ë¦­ì‹œ ì´ë¯¸ì§€ ë°°ê²½ìƒ‰ ìŠ¤íƒ€ì¼ì£¼ê¸° */
        .delImgItem .delImgInput {
            /*#imgDelCont [name=delImgId] { /* ìì† ì¤‘ì— ì´ë¦„ì´ delImgId */
            /*display: none; !* ì²´í¬ë°•ìŠ¤ ì•ˆë³´ì´ê²Œ ê°ì¶”ê¸° *!*/
        }

        .delImgItem > .delImgInput:checked + img { /* : ì‹¤ì œë¡œ ì¡´ì¬í•˜ì§€ëŠ” ì•ŠëŠ”, ìƒíƒœë¥¼ ì˜ë¯¸ */
            /*#imgDelCont [name=delImgId]:checked + img{ !*  ì²´í¬ê°€ ë˜ë©´ ê·¼ì ‘í•œ img íƒœê·¸ *!*/
            background-color: red;
        }
    </style>
</head>
<div layout:fragment="content">
    <!--  layout ì˜ ì»¨í…ì¸  ì˜ì—­ì„ ì´ ë¶€ë¶„ìœ¼ë¡œ í•˜ê² ë‹¤.-->
    <form enctype="multipart/form-data" name="registerForm" action="/board/modify.do" method="post"
          style="width: 500px;margin: 0 auto;">
        <input type="hidden" th:value="${b.bId}" name="bId"> <!-- bId ì´ë¦„ìœ¼ë¡œ ì…ë ¥ëœ ê°’ì„ b.bId ë¡œ ì„œë²„ì— ë„˜ê¸´ë‹¤ -->
        <h1 class="my-4">ê²Œì‹œê¸€ ìˆ˜ì •</h1>
        <p class="form-floating">
            <input readonly id="uIdInput" type="text" name="uId" th:value="${b.uId}" class="form-control"
                   placeholder="??">
            <label class="">ì•„ì´ë””(ê¸€ì“´ì´)</label>
        </p>

        <p id="imgDelCont">
        <h4>ì´ë¯¸ì§€ì‚­ì œ (ì²´í¬)</h4>
        <!--      íƒ€ì„ë¦¬í”„ ë°˜ë³µë¬¸ th:each // ìë™ìœ¼ë¡œ null ì²´í¬ë¥¼ í•´ì¤€ë‹¤ -->
        <!--     ë°˜ë³µë¬¸ ì¸ì 2ê°œ img ëŠ” ì´ë¯¸ì§€, state ëŠ” ìƒíƒœ // b.imgs : (íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸´) BoardDto b ì˜ í•„ë“œ imgs // ì´ë¯¸ì§€ë“¤ì˜ ì´ë¯¸ì§€ì™€ ì´ë¯¸ì§€ ìƒíƒœë¥¼ ë°˜ë³µë¬¸ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° -->
        <label th:each="img, state:${b.imgs}" class="w-25 delImgItem"> <!-- ì´ë¯¸ì§€ ë„ˆë¹„ ë¹„ìœ¨ ì£¼ê¸° w-25 -->
            <!--      ğŸ‰ ì´ë¯¸ì§€ì˜ biId ê°€ ìˆìœ¼ë©´ ì‚­ì œ, ì—†ìœ¼ë©´ ì´ë¯¸ì§€ ë“±ë¡-->
            <!-- ğŸ‰ì´ë¯¸ì§€ëŠ” ë°°ì—´ì´ë¼ì„œ!! // state.index : ì´ë¯¸ì§€ì˜ ìƒíƒœ ì¸ë±ìŠ¤ë²ˆí˜¸  => íŒŒë¼ë¯¸í„° BoardDto board ë¡œ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤. -->
            <!--        input name ì˜ imgs.biId == (íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸´) BoardDto b ì˜ í•„ë“œ imgs (ì¡°ì¸í•œ board_imgs í…Œì´ë¸”) ì˜ biId í•„ë“œ -->
            <!--        <input type="checkbox" class="delImgInput" th:name="'imgs['+${state.index}+'].biId'" th:value="${img.biId}">-->
            <!--        <input type="checkbox" class="delImgInput" name="imgs[0].biId" th:value="${img.biId}">-->
            <!--        name => imgs[0].biId // => ì»¨íŠ¸ë¡¤ëŸ¬ board.getImgs()) // => : [BoardImgDto(biId=33, bId=0, imgPath=null)]-->
            <input type="checkbox" class="delImgInput" name="delImgId" th:value="${img.biId}">
            <img th:src="@{'{path}'(path=${img.imgPath})}" class="img-thumbnail">
        </label>
        </p>
        <p id="imgCont">
            <button id="imgAddBtn" class="btn btn-primary w-100" type="button">
                New ì´ë¯¸ì§€
                <i class="bi bi-plus-square"></i>
            </button>
        </p>

        <p class="form-floating">
            <input id="titleInput" type="text" name="title" th:value="${b.title}" class="form-control" placeholder="??">
            <label class="">ê¸€ì œëª©</label>
        </p>
        <p>
            <!--    textarea ëŠ” ì•ˆì— ë‚´ìš©ì´ ë“¤ì–´ì™€ì•¼ í•´ì„œ ì—´ê³  ë‹«ì•„ì•¼ í•œë‹¤. <textarea></textarea>
                    value ê°€ ì—†ë‹¤. íƒœê·¸ ì•ˆì— ë“¤ì–´ê°€ëŠ” ê²Œ value ì´ë‹¤. => textarea ì˜ value ==> th:text
            -->
            <label for="contentInput" class="form-label">ê¸€ë‚´ìš©</label>
            <textarea id="contentInput" name="content" rows="4" class="form-control" th:text="${b.content}"></textarea>
        </p>

        <div class="mb-3">
            <label class="form-label">íƒœê·¸ ì‚­ì œ</label>
            <div class="form-control">
                <th:block th:each="t:${b.tags}">
<!--                    delTag ëˆ„ë¥¸ê²Œ t.tag ê°’ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤. -->
                    <input th:id="${t.tag}" name="delTag" th:value="${t.tag}" type="checkbox" class="btn-check" autocomplete="off">
                    <label th:for="${t.tag}" class="btn btn-outline-secondary btn-sm rounded-5 m-1">
                        <span th:text="${t.tag}"></span>
                        <i class="bi bi-x"></i>
                    </label>
                </th:block>
            </div>
        </div>
        <p class="mb-3">
            <label class="form-label">íƒœê·¸ë“±ë¡</label>
            <th:block th:include="/board/tagsinput.html"></th:block>
        </p>

        <p class="text-end">
            <!--  ë“±ë¡ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í•„ìš”í•˜ë‹¤. -->
            <button type="reset" class="btn btn-warning">ì´ˆê¸°í™”</button>
            <a th:href="@{'/board/{bId}/remove.do'(bId=${b.bId})}" class="btn btn-danger">ì‚­ì œ</a>
            <button type="submit" class="btn btn-primary">ìˆ˜ì •</button>
        </p>


    </form>
    <script>
        // innerHTML ì€ html ì„ ì „ì²´ ë°”ê¾¸ëŠ”ê²ƒ.
        // insertBefore / appencChild
        const imgAddBtn = document.getElementById("imgAddBtn");
        const imgCont = document.getElementById("imgCont");
        imgAddBtn.addEventListener("click", (e) => {
            imgCont.insertAdjacentHTML("beforeend", imgInputComponent());
        });


        // ì»¨í¬ë„ŒíŠ¸ë¥¼ ì“°ëŠ” ì´ìœ  ? ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ì•„ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
        function imgInputComponent(label = "ì´ë¯¸ì§€", name = "img") { // html ì„ ë¬¸ìì—´ë¡œ ê°€ì§€ê³  ìˆëŠ” ì»¨í¬ë„ŒíŠ¸
            // html ë¬¸ìì—´ ë°˜í™˜
            return `<p class="input-group mt-2">
                <label class="input-group-text">${label}</label>
                <input class="form-control" type="file" name="${name}">
                <button type="button" class="btn btn-danger" onclick="this.closest('.input-group').remove()"> <!--- í´ë˜ìŠ¤ ì´ë¦„ì´ input-group ë¶€ëª¨ì¤‘ì— í•˜ë‚˜ë§Œ ì„ íƒ -->
                    <i class="bi bi-x-lg"></i> <!-- x ì•„ì´ì½˜ -->
                </button>
              </p>`
        }
    </script>


</div>
</html>